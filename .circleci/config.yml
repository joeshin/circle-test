version: 2
jobs:
  build:
    docker:
      - image: circleci/golang:latest

    steps:
      - checkout
      - run: echo "hi"
      - run:
          name: Hault Postman Only Changes
          command: |
            # this script haults job execution early if the latest commit
            # is only changes in postman directory.
            last_commited_files=$(git log --pretty="" --name-only -n1)

            for f in $last_commited_files
            do
              dir=$(dirname "${f}")
              if [ $dir != "postman" ]; then
                echo "onwards... ğŸ‘"
                exit 0
              fi
            done

            echo "ğŸ›‘ haulting job, postman update"
            circleci-agent step halt
      - run: echo "bye"
